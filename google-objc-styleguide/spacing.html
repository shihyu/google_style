

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>留白和格式 &mdash; Google 開源項目風格指南</title>
    
    <link rel="stylesheet" href="../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/theme_extras.js"></script>
    <link rel="top" title="Google 開源項目風格指南" href="../index.html" />
    <link rel="up" title="Objective-C 風格指南 - 內容目錄" href="contents.html" />
    <link rel="next" title="命名" href="naming.html" />
    <link rel="prev" title="Google Objective-C Style Guide 中文版" href="index.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="../index.html">
          <span>Google 開源項目風格指南</span></a></h1>
        <h2 class="heading"><span>留白和格式</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="index.html">Google Objective-C Style Guide 中文版</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../contents.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="naming.html">命名</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="id1">
<h1>留白和格式</h1>
<div class="section" id="vs">
<h2>空格 vs. 製表符</h2>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">只使用空格，且一次縮進兩個空格。</p>
</div>
<p>我們使用空格縮進。不要在代碼中使用製表符。你應該將編輯器設置成自動將製表符替換成空格。</p>
</div>
<div class="section" id="id2">
<h2>行寬</h2>
<p>儘量讓你的代碼保持在 80 列之內。</p>
<p>我們深知 Objective-C 是一門繁冗的語言，在某些情況下略超 80 列可能有助于提高可讀性，但這也只能是特例而已，不能成為開脫。</p>
<p>如果閲讀代碼的人認為把把某行行寬保持在 80 列仍然有不失可讀性，你應該按他們說的去做。</p>
<p>我們意識到這條規則是有爭議的，但很多已經存在的代碼堅持了本規則，我們覺得保證一致性更重要。</p>
<p>通過設置 <a href="#id3"><span class="problematic" id="id4">*</span></a>Xcode &gt; Preferences &gt; Text Editing &gt; Show page guide*，來使越界更容易被發現。</p>
</div>
<div class="section" id="id5">
<h2>方法聲明和定義</h2>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<ul class="last simple">
<li>/ + 和返回類型之間須使用一個空格，參數列表中只有參數之間可以有空格。</li>
</ul>
</div>
<p>方法應該像這樣：</p>
<div class="highlight-objc"><div class="highlight"><pre><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">doSomethingWithString:</span><span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="n">theString</span> <span class="p">{</span>
  <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>星號前的空格是可選的。當寫新的代碼時，要與先前代碼保持一致。</p>
<p>如果一行有非常多的參數，更好的方式是將每個參數單獨拆成一行。如果使用多行，將每個參數前的冒號對齊。</p>
<div class="highlight-objc"><div class="highlight"><pre><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">doSomethingWith:</span><span class="p">(</span><span class="n">GTMFoo</span> <span class="o">*</span><span class="p">)</span><span class="n">theFoo</span>
                   <span class="nl">rect:</span><span class="p">(</span><span class="n">NSRect</span><span class="p">)</span><span class="n">theRect</span>
               <span class="nl">interval:</span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">theInterval</span> <span class="p">{</span>
  <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>當第一個關鍵字比其它的短時，保證下一行至少有 4 個空格的縮進。這樣可以使關鍵字垂直對齊，而不是使用冒號對齊：</p>
<div class="highlight-objc"><div class="highlight"><pre><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="kt">short</span><span class="o">:</span><span class="p">(</span><span class="n">GTMFoo</span> <span class="o">*</span><span class="p">)</span><span class="n">theFoo</span>
    <span class="nl">longKeyword:</span><span class="p">(</span><span class="n">NSRect</span><span class="p">)</span><span class="n">theRect</span>
    <span class="nl">evenLongerKeyword:</span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">theInterval</span> <span class="p">{</span>
  <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h2>方法調用</h2>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">方法調用應儘量保持與方法聲明的格式一致。當格式的風格有多種選擇時，新的代碼要與已有代碼保持一致。</p>
</div>
<p>調用時所有參數應該在同一行：</p>
<div class="highlight-objc"><div class="highlight"><pre><span class="p">[</span><span class="n">myObject</span> <span class="nl">doFooWith:</span><span class="n">arg1</span> <span class="nl">name:</span><span class="n">arg2</span> <span class="nl">error:</span><span class="n">arg3</span><span class="p">];</span>
</pre></div>
</div>
<p>或者每行一個參數，以冒號對齊：</p>
<div class="highlight-objc"><div class="highlight"><pre><span class="p">[</span><span class="n">myObject</span> <span class="nl">doFooWith:</span><span class="n">arg1</span>
               <span class="nl">name:</span><span class="n">arg2</span>
              <span class="nl">error:</span><span class="n">arg3</span><span class="p">];</span>
</pre></div>
</div>
<p>不要使用下面的縮進風格：</p>
<div class="highlight-objc"><div class="highlight"><pre><span class="p">[</span><span class="n">myObject</span> <span class="nl">doFooWith:</span><span class="n">arg1</span> <span class="nl">name:</span><span class="n">arg2</span>  <span class="c1">// some lines with &gt;1 arg</span>
              <span class="nl">error:</span><span class="n">arg3</span><span class="p">];</span>

<span class="p">[</span><span class="n">myObject</span> <span class="nl">doFooWith:</span><span class="n">arg1</span>
               <span class="nl">name:</span><span class="n">arg2</span> <span class="nl">error:</span><span class="n">arg3</span><span class="p">];</span>

<span class="p">[</span><span class="n">myObject</span> <span class="nl">doFooWith:</span><span class="n">arg1</span>
          <span class="nl">name:</span><span class="n">arg2</span>  <span class="c1">// aligning keywords instead of colons</span>
          <span class="nl">error:</span><span class="n">arg3</span><span class="p">];</span>
</pre></div>
</div>
<p>方法定義與方法聲明一樣，當關鍵字的長度不足以以冒號對齊時，下一行都要以四個空格進行縮進。</p>
<div class="highlight-objc"><div class="highlight"><pre><span class="p">[</span><span class="n">myObj</span> <span class="kt">short</span><span class="o">:</span><span class="n">arg1</span>
    <span class="nl">longKeyword:</span><span class="n">arg2</span>
    <span class="nl">evenLongerKeyword:</span><span class="n">arg3</span><span class="p">];</span>
</pre></div>
</div>
</div>
<div class="section" id="public-private">
<h2><tt class="docutils literal"><span class="pre">&#64;public</span></tt> 和 <tt class="docutils literal"><span class="pre">&#64;private</span></tt></h2>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last"><tt class="docutils literal"><span class="pre">&#64;public</span></tt> 和 <tt class="docutils literal"><span class="pre">&#64;private</span></tt> 訪問修飾符應該以一個空格縮進。</p>
</div>
<p>與 C++ 中的 <tt class="docutils literal"><span class="pre">public,</span> <span class="pre">private</span></tt> 以及 <tt class="docutils literal"><span class="pre">protected</span></tt> 非常相似。</p>
<div class="highlight-objc"><div class="highlight"><pre><span class="k">@interface</span> <span class="nc">MyClass</span> : <span class="nc">NSObject</span> <span class="p">{</span>
 <span class="k">@public</span>
  <span class="p">...</span>
 <span class="k">@private</span>
  <span class="p">...</span>
<span class="p">}</span>
<span class="k">@end</span>
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h2>異常</h2>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">每個 <tt class="docutils literal"><span class="pre">&#64;</span></tt> 標籤應該有獨立的一行，在 <tt class="docutils literal"><span class="pre">&#64;</span></tt> 與 <tt class="docutils literal"><span class="pre">{}</span></tt> 之間需要有一個空格， <tt class="docutils literal"><span class="pre">&#64;catch</span></tt> 與被捕捉到的異常對象的聲明之間也要有一個空格。</p>
</div>
<p>如果你決定使用 Objective-C 的異常，那麼就按下面的格式。不過你最好先看看 <a class="reference internal" href="features.html#avoid-throwing-exceptions"><em>避免拋出異常</em></a> 瞭解下為什麼不要使用異常。</p>
<div class="highlight-objc"><div class="highlight"><pre><span class="k">@try</span> <span class="p">{</span>
  <span class="n">foo</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">@catch</span> <span class="p">(</span><span class="n">NSException</span> <span class="o">*</span><span class="n">ex</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">bar</span><span class="p">(</span><span class="n">ex</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">@finally</span> <span class="p">{</span>
  <span class="n">baz</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id8">
<h2>協議名</h2>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">類型標識符和尖括號內的協議名之間，不能有任何空格。</p>
</div>
<p>這條規則適用於類聲明、實例變數以及方法聲明。例如：</p>
<div class="highlight-objc"><div class="highlight"><pre><span class="k">@interface</span> <span class="nc">MyProtocoledClass</span> : <span class="nc">NSObject</span><span class="o">&lt;</span><span class="n">NSWindowDelegate</span><span class="o">&gt;</span> <span class="p">{</span>
 <span class="k">@private</span>
  <span class="kt">id</span><span class="o">&lt;</span><span class="n">MyFancyDelegate</span><span class="o">&gt;</span> <span class="n">delegate_</span><span class="p">;</span>
<span class="p">}</span>
<span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">setDelegate:</span><span class="p">(</span><span class="kt">id</span><span class="o">&lt;</span><span class="n">MyFancyDelegate</span><span class="o">&gt;</span><span class="p">)</span><span class="n">aDelegate</span><span class="p">;</span>
<span class="k">@end</span>
</pre></div>
</div>
</div>
<div class="section" id="id9">
<h2>塊（閉包）</h2>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">塊（block）適合用在 target/selector 模式下創建回調方法時，因為它使代碼更易讀。塊中的代碼應該縮進 4 個空格。</p>
</div>
<p>取決於塊的長度，下列都是合理的風格準則：</p>
<ul class="simple">
<li>如果一行可以寫完塊，則沒必要換行。</li>
<li>如果不得不換行，關括號應與塊聲明的第一個字元對齊。</li>
<li>塊內的代碼須按 4 空格縮進。</li>
<li>如果塊太長，比如超過 20 行，建議把它定義成一個局部變數，然後再使用該變數。</li>
<li>如果塊不帶參數，``^{`` 之間無須空格。如果帶有參數，``^(`` 之間無須空格，但 <tt class="docutils literal"><span class="pre">)</span> <span class="pre">{</span></tt> 之間須有一個空格。</li>
<li>塊內允許按兩個空格縮進，但前提是和項目的其它代碼保持一致的縮進風格。</li>
</ul>
<div class="highlight-objc"><div class="highlight"><pre><span class="c1">// The entire block fits on one line.</span>
<span class="p">[</span><span class="n">operation</span> <span class="nl">setCompletionBlock:</span><span class="o">^</span><span class="p">{</span> <span class="p">[</span><span class="n">self</span> <span class="n">onOperationDone</span><span class="p">];</span> <span class="p">}];</span>

<span class="c1">// The block can be put on a new line, indented four spaces, with the</span>
<span class="c1">// closing brace aligned with the first character of the line on which</span>
<span class="c1">// block was declared.</span>
<span class="p">[</span><span class="n">operation</span> <span class="nl">setCompletionBlock:</span><span class="o">^</span><span class="p">{</span>
    <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">delegate</span> <span class="n">newDataAvailable</span><span class="p">];</span>
<span class="p">}];</span>

<span class="c1">// Using a block with a C API follows the same alignment and spacing</span>
<span class="c1">// rules as with Objective-C.</span>
<span class="n">dispatch_async</span><span class="p">(</span><span class="n">fileIOQueue_</span><span class="p">,</span> <span class="o">^</span><span class="p">{</span>
    <span class="n">NSString</span><span class="o">*</span> <span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="n">self</span> <span class="n">sessionFilePath</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// An example where the parameter wraps and the block declaration fits</span>
<span class="c1">// on the same line. Note the spacing of |^(SessionWindow *window) {|</span>
<span class="c1">// compared to |^{| above.</span>
<span class="p">[[</span><span class="n">SessionService</span> <span class="n">sharedService</span><span class="p">]</span>
    <span class="nl">loadWindowWithCompletionBlock:</span><span class="o">^</span><span class="p">(</span><span class="n">SessionWindow</span> <span class="o">*</span><span class="n">window</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">window</span><span class="p">)</span> <span class="p">{</span>
          <span class="p">[</span><span class="n">self</span> <span class="nl">windowDidLoad:</span><span class="n">window</span><span class="p">];</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="p">[</span><span class="n">self</span> <span class="n">errorLoadingWindow</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}];</span>

<span class="c1">// An example where the parameter wraps and the block declaration does</span>
<span class="c1">// not fit on the same line as the name.</span>
<span class="p">[[</span><span class="n">SessionService</span> <span class="n">sharedService</span><span class="p">]</span>
    <span class="nl">loadWindowWithCompletionBlock:</span>
        <span class="o">^</span><span class="p">(</span><span class="n">SessionWindow</span> <span class="o">*</span><span class="n">window</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">window</span><span class="p">)</span> <span class="p">{</span>
              <span class="p">[</span><span class="n">self</span> <span class="nl">windowDidLoad:</span><span class="n">window</span><span class="p">];</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
              <span class="p">[</span><span class="n">self</span> <span class="n">errorLoadingWindow</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}];</span>

<span class="c1">// Large blocks can be declared out-of-line.</span>
<span class="kt">void</span> <span class="p">(</span><span class="o">^</span><span class="n">largeBlock</span><span class="p">)(</span><span class="kt">void</span><span class="p">)</span> <span class="o">=</span> <span class="o">^</span><span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">};</span>
<span class="p">[</span><span class="n">operationQueue_</span> <span class="nl">addOperationWithBlock:</span><span class="n">largeBlock</span><span class="p">];</span>
</pre></div>
</div>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="index.html">Google Objective-C Style Guide 中文版</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../contents.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="naming.html">命名</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright .
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>