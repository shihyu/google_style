

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>4. 來自 Google 的奇技 &mdash; Google 開源項目風格指南</title>
    
    <link rel="stylesheet" href="../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/theme_extras.js"></script>
    <link rel="top" title="Google 開源項目風格指南" href="../index.html" />
    <link rel="up" title="C++ 風格指南 - 內容目錄" href="contents.html" />
    <link rel="next" title="5. 其他 C++ 特性" href="others.html" />
    <link rel="prev" title="3. 類" href="classes.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="../index.html">
          <span>Google 開源項目風格指南</span></a></h1>
        <h2 class="heading"><span>4. 來自 Google 的奇技</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="classes.html">3. 類</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../contents.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="others.html">5. 其他 C++ 特性</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="google">
<h1>4. 來自 Google 的奇技</h1>
<p>Google 用了很多自己實現的技巧 / 工具使 C++ 代碼更加健壯, 我們使用 C++ 的方式可能和你在其它地方見到的有所不同.</p>
<div class="section" id="id1">
<h2>4.1. 智能指針</h2>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">如果確實需要使用智能指針的話, <tt class="docutils literal"><span class="pre">scoped_ptr</span></tt> 完全可以勝任. 你應該只在非常特定的情況下使用 <tt class="docutils literal"><span class="pre">std::tr1::shared_ptr</span></tt>, 例如 STL 容器中的對象. 任何情況下都不要使用 <tt class="docutils literal"><span class="pre">auto_ptr</span></tt>.</p>
</div>
<p>&#8220;智能&#8221; 指針看上去是指針, 其實是附加了語義的對象. 以 <tt class="docutils literal"><span class="pre">scoped_ptr</span></tt> 為例, <tt class="docutils literal"><span class="pre">scoped_ptr</span></tt> 被銷毀時, 它會刪除所指向的對象. <tt class="docutils literal"><span class="pre">shared_ptr</span></tt> 也是如此, 並且 <tt class="docutils literal"><span class="pre">shared_ptr</span></tt> 實現了引用計數, 所以最後一個 <tt class="docutils literal"><span class="pre">shared_ptr</span></tt> 對象析構時, 如果檢測到引用次數為 0，就會銷毀所指向的對象.</p>
<p>一般來說，我們傾向于設計對象隷屬明確的代碼, 最明確的對象隷屬是根本不使用指針, 直接將對象作為一個作用域或局部變數使用. 另一種極端做法是, 引用計數指針不屬於任何對象. 這種方法的問題是容易導致循環引用, 或者導致某個對象無法刪除的詭異狀態, 而且在每一次拷貝或賦值時連原子操作都會很慢.</p>
<p>雖然不推薦使用引用計數指針, 但有些時候它們的確是最簡單有效的解決方案.</p>
<p>(YuleFox 註: 看來, Google 所謂的不同之處, 在於儘量避免使用智能指針 :D, 使用時也儘量局部化, 並且, 安全第一)</p>
</div>
<div class="section" id="cpplint">
<h2>4.2. cpplint</h2>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">使用 <tt class="docutils literal"><span class="pre">cpplint.py</span></tt> 檢查風格錯誤.</p>
</div>
<p><tt class="docutils literal"><span class="pre">cpplint.py</span></tt> 是一個用來分析源檔案, 能檢查出多種風格錯誤的工具. 它不併完美, 甚至還會漏報和誤報, 但它仍然是一個非常有用的工具. 用行註釋 <tt class="docutils literal"><span class="pre">//</span> <span class="pre">NOLINT</span></tt> 可以忽略誤報.</p>
<p>某些項目會指導你如何使用他們的項目工具運行 <tt class="docutils literal"><span class="pre">cpplint.py</span></tt>. 如果你參與的項目沒有提供, 你可以單獨下載 <a class="reference external" href="http://google-styleguide.googlecode.com/svn/trunk/cpplint/cpplint.py">cpplint.py</a>.</p>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="classes.html">3. 類</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../contents.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="others.html">5. 其他 C++ 特性</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright .
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>